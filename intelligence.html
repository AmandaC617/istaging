<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>å¸‚å ´æƒ…è³‡èˆ‡ç«¶å“åˆ†æå¹³å° (V6 - é€²éšåˆ†æç‰ˆ)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://apis.google.com/js/api.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // Tailwind CSS configuration
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        techbg: '#181D27',
                        techpanel: '#22283A',
                        techaccent: '#2EE9E4',
                        techprimary: '#3762F0',
                        techsecondary: '#7D5FFF'
                    },
                    fontFamily: {
                        'tech': ['"Segoe UI"', 'Roboto', 'Arial', 'sans-serif']
                    }
                }
            }
        }

        // å…¨åŸŸç‹€æ…‹ç®¡ç†
        window.state = {
            isAuthenticated: false,
            apiConfigured: false,
            currentStep: 1,
            analysisData: {},
            settings: {
                googleApiKey: '',
                searchEngineId: '',
                centralFolderName: 'iStaging_å°ˆæ¡ˆç®¡ç†',
                intelligenceSubfolder: '01_å¸‚å ´æƒ…è³‡åˆ†æ',
                mediaplanSubfolder: '02_åª’é«”ææ¡ˆ',
                workflowSubfolder: '03_å·¥ä½œæµç¨‹æ–‡ä»¶'
            }
        };

        // é é¢è¼‰å…¥å®Œæˆå¾Œåˆå§‹åŒ–
        window.addEventListener('load', function() {
            console.log('é é¢è¼‰å…¥å®Œæˆï¼Œé–‹å§‹åˆå§‹åŒ–...');
            
            // ä½¿ç”¨ Promise åŒ…è£åˆå§‹åŒ–ï¼Œé¿å…æœªæ•ç²çš„éŒ¯èª¤
            initializeApp()
                .then(() => {
                    console.log('åˆå§‹åŒ–å®Œæˆ');
                })
                .catch(error => {
                    console.error('åˆå§‹åŒ–éç¨‹ä¸­ç™¼ç”ŸéŒ¯èª¤:', error);
                    showAlert('åˆå§‹åŒ–éŒ¯èª¤', 'é é¢åˆå§‹åŒ–å¤±æ•—ï¼Œè«‹é‡æ–°æ•´ç†é é¢', 'error');
                });
        });

        // å…¨åŸŸéŒ¯èª¤è™•ç†
        window.addEventListener('error', function(event) {
            console.error('å…¨åŸŸéŒ¯èª¤:', event.error);
        });

        window.addEventListener('unhandledrejection', function(event) {
            console.error('æœªè™•ç†çš„ Promise æ‹’çµ•:', event.reason);
            event.preventDefault(); // é˜²æ­¢é è¨­çš„éŒ¯èª¤è™•ç†
        });

        // åˆå§‹åŒ–æ‡‰ç”¨ç¨‹å¼
        function initializeApp() {
            return new Promise((resolve, reject) => {
                try {
                    console.log('åˆå§‹åŒ–æ‡‰ç”¨ç¨‹å¼...');
                    
                    // è¼‰å…¥è¨­å®š
                    loadSettings();
                    
                    // è¨­å®šäº‹ä»¶ç›£è½å™¨
                    setupEventListeners();
                    
                    // æª¢æŸ¥ URL åƒæ•¸
                    checkUrlParameters();
                    
                    // æ›´æ–° UI ç‹€æ…‹
                    updateUIState();
                    
                    console.log('æ‡‰ç”¨ç¨‹å¼åˆå§‹åŒ–å®Œæˆ');
                    resolve();
                } catch (error) {
                    console.error('æ‡‰ç”¨ç¨‹å¼åˆå§‹åŒ–å¤±æ•—:', error);
                    reject(error);
                }
            });
        }

        // è¼‰å…¥è¨­å®š
        function loadSettings() {
            try {
                const savedSettings = localStorage.getItem('intelligence_settings');
                if (savedSettings) {
                    const parsed = JSON.parse(savedSettings);
                    state.settings = { ...state.settings, ...parsed };
                    
                    // æ›´æ–°è¡¨å–®æ¬„ä½
                    const apiKeyInput = document.getElementById('google-api-key');
                    const searchEngineInput = document.getElementById('search-engine-id');
                    const centralFolderInput = document.getElementById('central-folder-name');
                    const intelligenceSubfolderInput = document.getElementById('intelligence-subfolder');
                    const mediaplanSubfolderInput = document.getElementById('mediaplan-subfolder');
                    const workflowSubfolderInput = document.getElementById('workflow-subfolder');
                    
                    if (apiKeyInput) apiKeyInput.value = state.settings.googleApiKey || '';
                    if (searchEngineInput) searchEngineInput.value = state.settings.searchEngineId || '';
                    if (centralFolderInput) centralFolderInput.value = state.settings.centralFolderName || '';
                    if (intelligenceSubfolderInput) intelligenceSubfolderInput.value = state.settings.intelligenceSubfolder || '';
                    if (mediaplanSubfolderInput) mediaplanSubfolderInput.value = state.settings.mediaplanSubfolder || '';
                    if (workflowSubfolderInput) workflowSubfolderInput.value = state.settings.workflowSubfolder || '';
                }
            } catch (error) {
                console.warn('è¼‰å…¥è¨­å®šå¤±æ•—:', error);
                // ä¸æ‹‹å‡ºéŒ¯èª¤ï¼Œè®“ç¨‹å¼ç¹¼çºŒåŸ·è¡Œ
            }
        }

        // è¨­å®šäº‹ä»¶ç›£è½å™¨
        function setupEventListeners() {
            try {
                // æ¨™ç±¤é åˆ‡æ›
                const tabButtons = document.querySelectorAll('.tab-btn');
                tabButtons.forEach(btn => {
                    if (btn) {
                        btn.addEventListener('click', function(e) {
                            e.preventDefault();
                            const tab = this.dataset.tab;
                            switchTab(tab);
                        });
                    }
                });

                // å„²å­˜è¨­å®šæŒ‰éˆ•
                const saveSettingsBtn = document.getElementById('save-settings-btn');
                if (saveSettingsBtn) {
                    saveSettingsBtn.addEventListener('click', saveSettings);
                }

                // Google ç™»å…¥æŒ‰éˆ•
                const authorizeBtn = document.getElementById('authorize_button');
                if (authorizeBtn) {
                    authorizeBtn.addEventListener('click', handleGoogleAuth);
                }

                // ç™»å‡ºæŒ‰éˆ•
                const signoutBtn = document.getElementById('signout_button');
                if (signoutBtn) {
                    signoutBtn.addEventListener('click', handleSignOut);
                }

                // æ­¥é©Ÿåˆ‡æ›
                const stepCircles = document.querySelectorAll('.step-circle');
                stepCircles.forEach(circle => {
                    if (circle) {
                        circle.addEventListener('click', function() {
                            const step = parseInt(this.textContent);
                            goToStep(step);
                        });
                    }
                });

                console.log('äº‹ä»¶ç›£è½å™¨è¨­å®šå®Œæˆ');
            } catch (error) {
                console.error('è¨­å®šäº‹ä»¶ç›£è½å™¨å¤±æ•—:', error);
                // ä¸æ‹‹å‡ºéŒ¯èª¤ï¼Œè®“ç¨‹å¼ç¹¼çºŒåŸ·è¡Œ
            }
        }

        // æª¢æŸ¥ URL åƒæ•¸
        function checkUrlParameters() {
            try {
                const urlParams = new URLSearchParams(window.location.search);
                const projectId = urlParams.get('projectId');
                
                if (projectId) {
                    const projectIdInput = document.getElementById('project-id');
                    if (projectIdInput) {
                        projectIdInput.value = projectId;
                    }
                }
            } catch (error) {
                console.warn('æª¢æŸ¥ URL åƒæ•¸å¤±æ•—:', error);
                // ä¸æ‹‹å‡ºéŒ¯èª¤ï¼Œè®“ç¨‹å¼ç¹¼çºŒåŸ·è¡Œ
            }
        }

        // æ›´æ–° UI ç‹€æ…‹
        function updateUIState() {
            try {
                const appContainer = document.getElementById('app-container');
                const analysisPanel = document.getElementById('analysis-panel');
                const historyPanel = document.getElementById('history-panel');
                const isConfigured = state.settings.googleApiKey && state.settings.searchEngineId;
                
                // ç§»é™¤ app-container çš„ locked classï¼Œæ”¹ç‚ºåªé–å®šç‰¹å®šé¢æ¿
                if (appContainer) {
                    appContainer.classList.remove('locked');
                }
                
                // åªæœ‰åˆ†æç³»çµ±å’Œæ­·å²ç´€éŒ„éœ€è¦ API è¨­å®š
                if (analysisPanel) {
                    if (isConfigured) {
                        analysisPanel.classList.remove('locked');
                        state.apiConfigured = true;
                    } else {
                        analysisPanel.classList.add('locked');
                        state.apiConfigured = false;
                    }
                }
                
                if (historyPanel) {
                    if (isConfigured) {
                        historyPanel.classList.remove('locked');
                    } else {
                        historyPanel.classList.add('locked');
                    }
                }

                // é è¨­é¡¯ç¤º API è¨­å®šåˆ†é 
                switchTab('settings');
            } catch (error) {
                console.error('æ›´æ–° UI ç‹€æ…‹å¤±æ•—:', error);
            }
        }

        // åˆ‡æ›æ¨™ç±¤é 
        function switchTab(tabName) {
            try {
                // ç§»é™¤æ‰€æœ‰æ¨™ç±¤é çš„ active ç‹€æ…‹
                const tabButtons = document.querySelectorAll('.tab-btn');
                const panels = document.querySelectorAll('.panel');
                
                tabButtons.forEach(btn => btn.classList.remove('active'));
                panels.forEach(panel => panel.classList.remove('active'));
                
                // å•Ÿç”¨é¸ä¸­çš„æ¨™ç±¤é 
                const activeTab = document.querySelector(`[data-tab="${tabName}"]`);
                const activePanel = document.getElementById(`${tabName}-panel`);
                
                if (activeTab) activeTab.classList.add('active');
                if (activePanel) activePanel.classList.add('active');
                
                console.log(`åˆ‡æ›åˆ°æ¨™ç±¤é : ${tabName}`);
            } catch (error) {
                console.error('åˆ‡æ›æ¨™ç±¤é å¤±æ•—:', error);
            }
        }

        // å„²å­˜è¨­å®š
        function saveSettings() {
            try {
                const apiKey = document.getElementById('google-api-key')?.value || '';
                const searchEngineId = document.getElementById('search-engine-id')?.value || '';
                const centralFolderName = document.getElementById('central-folder-name')?.value || '';
                const intelligenceSubfolder = document.getElementById('intelligence-subfolder')?.value || '';
                const mediaplanSubfolder = document.getElementById('mediaplan-subfolder')?.value || '';
                const workflowSubfolder = document.getElementById('workflow-subfolder')?.value || '';

                // æ›´æ–°ç‹€æ…‹
                state.settings = {
                    googleApiKey: apiKey,
                    searchEngineId: searchEngineId,
                    centralFolderName: centralFolderName,
                    intelligenceSubfolder: intelligenceSubfolder,
                    mediaplanSubfolder: mediaplanSubfolder,
                    workflowSubfolder: workflowSubfolder
                };

                // å„²å­˜åˆ° localStorage
                localStorage.setItem('intelligence_settings', JSON.stringify(state.settings));

                // æ›´æ–° UI ç‹€æ…‹
                updateUIState();

                showAlert('è¨­å®šå·²å„²å­˜', 'API è¨­å®šå·²æˆåŠŸå„²å­˜', 'success');
                
                // å¦‚æœ API å·²è¨­å®šï¼Œåˆ‡æ›åˆ°åˆ†æç³»çµ±
                if (apiKey && searchEngineId) {
                    setTimeout(() => {
                        switchTab('analysis');
                    }, 1000);
                }
            } catch (error) {
                console.error('å„²å­˜è¨­å®šå¤±æ•—:', error);
                showAlert('å„²å­˜å¤±æ•—', error.message, 'error');
            }
        }

        // Google èªè­‰è™•ç†
        function handleGoogleAuth() {
            try {
                console.log('Google ç™»å…¥åŠŸèƒ½å¾…å¯¦ä½œ');
                showAlert('åŠŸèƒ½é–‹ç™¼ä¸­', 'Google ç™»å…¥åŠŸèƒ½æ­£åœ¨é–‹ç™¼ä¸­', 'info');
            } catch (error) {
                console.error('Google èªè­‰å¤±æ•—:', error);
                showAlert('èªè­‰å¤±æ•—', error.message, 'error');
            }
        }

        // ç™»å‡ºè™•ç†
        function handleSignOut() {
            try {
                state.isAuthenticated = false;
                updateAuthUI();
                showAlert('å·²ç™»å‡º', 'æ‚¨å·²æˆåŠŸç™»å‡º', 'info');
            } catch (error) {
                console.error('ç™»å‡ºå¤±æ•—:', error);
            }
        }

        // æ›´æ–°èªè­‰ UI
        function updateAuthUI() {
            try {
                const userProfile = document.getElementById('user-profile');
                const authorizeBtn = document.getElementById('authorize_button');
                
                if (state.isAuthenticated) {
                    if (userProfile) userProfile.classList.remove('hidden');
                    if (authorizeBtn) authorizeBtn.classList.add('hidden');
                } else {
                    if (userProfile) userProfile.classList.add('hidden');
                    if (authorizeBtn) authorizeBtn.classList.remove('hidden');
                }
            } catch (error) {
                console.error('æ›´æ–°èªè­‰ UI å¤±æ•—:', error);
            }
        }

        // åˆ‡æ›æ­¥é©Ÿ
        function goToStep(step) {
            try {
                state.currentStep = step;
                
                // æ›´æ–°æ­¥é©ŸæŒ‡ç¤ºå™¨
                const steps = document.querySelectorAll('.step');
                steps.forEach((s, index) => {
                    if (index + 1 < step) {
                        s.classList.add('completed');
                        s.classList.remove('active');
                    } else if (index + 1 === step) {
                        s.classList.add('active');
                        s.classList.remove('completed');
                    } else {
                        s.classList.remove('active', 'completed');
                    }
                });

                // é¡¯ç¤ºå°æ‡‰çš„å…§å®¹
                const stepPanels = document.querySelectorAll('.step-panel');
                stepPanels.forEach((panel, index) => {
                    if (index + 1 === step) {
                        panel.style.display = 'block';
                    } else {
                        panel.style.display = 'none';
                    }
                });

                console.log(`åˆ‡æ›åˆ°æ­¥é©Ÿ: ${step}`);
            } catch (error) {
                console.error('åˆ‡æ›æ­¥é©Ÿå¤±æ•—:', error);
            }
        }

        // é¡¯ç¤ºè­¦å‘Šè¨Šæ¯
        function showAlert(title, message, type = 'info') {
            try {
                const alertContainer = document.getElementById('alert-container');
                if (!alertContainer) return;

                const alertDiv = document.createElement('div');
                alertDiv.className = `p-4 mb-4 rounded-lg shadow-lg ${
                    type === 'error' ? 'bg-red-600 text-white' :
                    type === 'success' ? 'bg-green-600 text-white' :
                    type === 'warning' ? 'bg-yellow-600 text-white' :
                    'bg-blue-600 text-white'
                }`;
                
                alertDiv.innerHTML = `
                    <div class="flex justify-between items-start">
                        <div>
                            <h4 class="font-bold">${title}</h4>
                            <p class="text-sm mt-1">${message}</p>
                        </div>
                        <button onclick="this.parentElement.parentElement.remove()" class="ml-4 text-white hover:text-gray-200">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                `;

                alertContainer.appendChild(alertDiv);

                // è‡ªå‹•ç§»é™¤è­¦å‘Š
                setTimeout(() => {
                    if (alertDiv.parentElement) {
                        alertDiv.remove();
                    }
                }, 5000);
            } catch (error) {
                console.error('é¡¯ç¤ºè­¦å‘Šå¤±æ•—:', error);
            }
        }
    </script>
    <style>
        /* Base styling and animations */
        body { font-family: "Segoe UI", Roboto, Arial, sans-serif; }
        .tab-main.active { border-color: #2EE9E4; background-color: #181D27; color: #2EE9E4; }
        .panel { display: none; }
        .panel.active { display: block; animation: fadeIn 0.5s ease; }
        .locked { opacity: 0.5; pointer-events: none; }
        .spinner { border: 4px solid rgba(59,130,246,.2); width: 36px; height: 36px; border-radius: 50%; border-left-color: #2EE9E4; animation: spin 1s ease infinite; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes spin { to { transform: rotate(360deg); } }
        
        /* Table and result panel styling */
        th, td { padding: 12px 15px; }
        .result-panel { max-height: 65vh; overflow-y: auto; }
        .overflow-x-auto { overflow-x: auto; }

        /* Custom scrollbar */
        ::-webkit-scrollbar { height: 8px; width: 8px; }
        ::-webkit-scrollbar-track { background: #181D27; }
        ::-webkit-scrollbar-thumb { background: #3762F0; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #7D5FFF; }

        /* Stepper UI */
        .stepper-container { display: flex; justify-content: space-between; margin-bottom: 1.5rem; }
        .step { flex: 1; text-align: center; position: relative; }
        .step-circle { width: 32px; height: 32px; line-height: 30px; border-radius: 50%; background-color: #22283A; color: #fff; display: inline-block; border: 2px solid #3762F0; font-weight: bold; cursor: pointer; transition: all .3s ease; }
        .step-title { margin-top: 0.5rem; font-size: 0.875rem; color: #9ca3af; }
        .step-line { position: absolute; top: 16px; left: 50%; width: 100%; height: 2px; background-color: #3762F0; z-index: -1; }
        .step:first-child .step-line { left: 50%; width: 50%; }
        .step:last-child .step-line { left: 0; width: 50%;}
        
        .step.active .step-circle { background-color: #3762F0; color: #fff; border-color: #2EE9E4; transform: scale(1.1); }
        .step.active .step-title { color: #2EE9E4; font-weight: bold; }
        .step.completed .step-circle { background-color: #2EE9E4; color: #181D27; border-color: #2EE9E4; }
        .step.completed .step-title { color: #d1d5db; }

        /* Badge Styles */
        .badge { display: inline-block; padding: 2px 10px; border-radius: 12px; font-weight: 600; font-size: 0.75rem; }
        .badge-high { background-color: #ef4444; color: white; }
        .badge-mid { background-color: #f97316; color: white; }
        .badge-low { background-color: #22c55e; color: white; }
        .badge-unknown { background-color: #6b7280; color: white; }

        /* Dashboard Cards */
        .dashboard-card { background: linear-gradient(135deg, #22283A 0%, #1a1f2e 100%); border: 1px solid #3762F0; border-radius: 12px; padding: 1.5rem; }
        .metric-value { font-size: 2rem; font-weight: bold; color: #2EE9E4; }
        .metric-label { color: #9ca3af; font-size: 0.875rem; margin-top: 0.5rem; }

        /* Comparison Table */
        .comparison-table { border-collapse: separate; border-spacing: 0; }
        .comparison-table th { background: #1a1f2e; border: 1px solid #3762F0; padding: 12px; }
        .comparison-table td { border: 1px solid #3762F0; padding: 12px; }
        .comparison-table tr:nth-child(even) { background: rgba(55, 98, 240, 0.05); }

        /* Chart Container */
        .chart-container { position: relative; height: 300px; margin: 1rem 0; }
    </style>
</head>
<body class="bg-techbg font-tech text-gray-100 min-h-screen">
    <!-- Header Section -->
    <header class="bg-techpanel shadow-lg sticky top-0 z-40">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <h1 class="text-3xl font-extrabold tracking-wide text-techaccent flex items-center gap-2">
                <svg class="w-8 h-8 text-techprimary inline-block" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M12 3v2m0 14v2m9-9h-2M5 12H3m15.364-7.364l-1.414 1.414M6.05 17.95l-1.414 1.414m12.728 0l1.414-1.414M6.05 6.05L4.636 4.636" stroke-linecap="round" stroke-linejoin="round"></path></svg>
                å¸‚å ´æƒ…è³‡èˆ‡ç«¶å“åˆ†æå¹³å°
            </h1>
            <div id="auth-container">
                <div class="flex items-center gap-4">
                    <div id="user-profile" class="hidden items-center gap-3">
                        <img id="user-avatar" class="w-10 h-10 rounded-full" src="" alt="User Avatar">
                        <span id="user-name" class="font-semibold text-gray-200"></span>
                        <button id="signout_button" class="text-sm text-gray-400 hover:text-techaccent">ç™»å‡º</button>
                    </div>
                     <button id="authorize_button" class="hidden bg-gradient-to-tr from-techprimary to-techaccent hover:from-techsecondary hover:to-techaccent font-bold text-white px-5 py-2 rounded-lg shadow-lg">ç™»å…¥ Google</button>
                </div>
                <div class="text-xs text-yellow-400 mt-2">â€» éœ€æˆæ¬Š Google Drive å…¨æ¬Šé™æ‰èƒ½æ­£ç¢ºå„²å­˜è³‡æ–™</div>
            </div>
        </div>
    </header>

    <div id="alert-container" class="fixed top-24 right-6 z-50"></div>

    <main class="container mx-auto px-6 py-8">
        <div id="app-container" class="locked">
            <!-- Main Tabs -->
            <div class="flex border-b border-techprimary/20 mb-6">
                <button data-tab="analysis" class="tab-main tab-btn active flex-1 p-4 font-semibold">åˆ†æç³»çµ±</button>
                <button data-tab="settings" class="tab-main tab-btn flex-1 p-4 font-semibold">API è¨­å®š</button>
                <button data-tab="history" class="tab-main tab-btn flex-1 p-4 font-semibold">æ­·å²ç´€éŒ„</button>
            </div>

            <!-- API è¨­å®šé¢æ¿ -->
            <div id="settings-panel" class="panel">
                <section class="bg-techpanel rounded-xl shadow-2xl border border-techprimary/20 p-8 max-w-lg mx-auto">
                    <h2 class="text-2xl font-bold mb-6 text-techaccent text-center">API èˆ‡æ‡‰ç”¨ç¨‹å¼è¨­å®š</h2>
                    <div class="space-y-4">
                        <div><label for="google-api-key" class="block text-sm font-medium text-gray-300">Google API é‡‘é‘°</label><input type="password" id="google-api-key" class="mt-1 w-full px-4 py-2 rounded-lg bg-techbg border border-techprimary/20" placeholder="å¡«å¯« Gemini/Custom Search API Key"></div>
                        <div><label for="search-engine-id" class="block text-sm font-medium text-gray-300">å¯ç¨‹å¼åŒ–æœå°‹å¼•æ“ ID (CX)</label><input type="text" id="search-engine-id" class="mt-1 w-full px-4 py-2 rounded-lg bg-techbg border border-techprimary/20" placeholder="å¡«å¯« Custom Search Engine ID"></div>
                        
                        <!-- é›†ä¸­åŒ–è³‡æ–™å¤¾ç®¡ç†è¨­å®š -->
                        <div class="border-t border-techprimary/30 pt-4 mt-6">
                            <h3 class="text-lg font-semibold text-techaccent mb-4">ğŸ“ é›†ä¸­åŒ–è³‡æ–™å¤¾ç®¡ç†</h3>
                            <div class="space-y-4">
                                <div>
                                    <label for="central-folder-name" class="block text-sm font-medium text-gray-300">ä¸»è¦å°ˆæ¡ˆè³‡æ–™å¤¾åç¨±</label>
                                    <input type="text" id="central-folder-name" class="mt-1 w-full px-4 py-2 rounded-lg bg-techbg border border-techprimary/20" value="iStaging_å°ˆæ¡ˆç®¡ç†" placeholder="ä¾‹å¦‚: iStaging_å°ˆæ¡ˆç®¡ç†">
                                    <p class="text-xs text-gray-400 mt-1">æ­¤è³‡æ–™å¤¾å°‡åŒ…å«æ‰€æœ‰å°ˆæ¡ˆçš„å­è³‡æ–™å¤¾</p>
                                </div>
                                <div>
                                    <label for="intelligence-subfolder" class="block text-sm font-medium text-gray-300">å¸‚å ´æƒ…è³‡å­è³‡æ–™å¤¾åç¨±</label>
                                    <input type="text" id="intelligence-subfolder" class="mt-1 w-full px-4 py-2 rounded-lg bg-techbg border border-techprimary/20" value="01_å¸‚å ´æƒ…è³‡åˆ†æ" placeholder="ä¾‹å¦‚: 01_å¸‚å ´æƒ…è³‡åˆ†æ">
                                </div>
                                <div>
                                    <label for="mediaplan-subfolder" class="block text-sm font-medium text-gray-300">åª’é«”ææ¡ˆå­è³‡æ–™å¤¾åç¨±</label>
                                    <input type="text" id="mediaplan-subfolder" class="mt-1 w-full px-4 py-2 rounded-lg bg-techbg border border-techprimary/20" value="02_åª’é«”ææ¡ˆ" placeholder="ä¾‹å¦‚: 02_åª’é«”ææ¡ˆ">
                                </div>
                                <div>
                                    <label for="workflow-subfolder" class="block text-sm font-medium text-gray-300">å·¥ä½œæµç¨‹å­è³‡æ–™å¤¾åç¨±</label>
                                    <input type="text" id="workflow-subfolder" class="mt-1 w-full px-4 py-2 rounded-lg bg-techbg border border-techprimary/20" value="03_å·¥ä½œæµç¨‹æ–‡ä»¶" placeholder="ä¾‹å¦‚: 03_å·¥ä½œæµç¨‹æ–‡ä»¶">
                                </div>
                            </div>
                        </div>
                        
                        <button id="save-settings-btn" class="w-full bg-gradient-to-tr from-techprimary to-techaccent font-bold text-white px-5 py-3 rounded-lg shadow-lg mt-6">å„²å­˜è¨­å®š</button>
                    </div>
                </section>
            </div>

            <!-- åˆ†æç³»çµ±é¢æ¿ -->
            <div id="analysis-panel" class="panel">
                <!-- Stepper -->
                <div class="stepper-container mb-8">
                    <div id="step-1" class="step active">
                        <div class="step-circle">1</div>
                        <div class="step-title">åˆ†æè¨­å®š</div>
                        <div class="step-line"></div>
                    </div>
                    <div id="step-2" class="step">
                        <div class="step-circle">2</div>
                        <div class="step-title">å°æ‰‹ç¯©é¸èˆ‡è£œå……</div>
                        <div class="step-line"></div>
                    </div>
                    <div id="step-3" class="step">
                        <div class="step-circle">3</div>
                        <div class="step-title">å®Œæ•´å ±å‘Š</div>
                    </div>
                </div>

                <!-- Step 1: åˆ†æè¨­å®š -->
                <div id="step-1-content" class="step-panel">
                    <section class="bg-techpanel rounded-xl shadow-2xl border border-techprimary/20 p-8">
                        <h2 class="text-2xl font-bold mb-6 text-techaccent">ğŸ“Š åˆ†æè¨­å®š</h2>
                        
                        <!-- Project ID è¼¸å…¥ -->
                        <div class="mb-6">
                            <label for="project-id" class="block text-sm font-medium text-gray-300 mb-2">å°ˆæ¡ˆ ID (å¯é¸)</label>
                            <input type="text" id="project-id" class="w-full px-4 py-2 rounded-lg bg-techbg border border-techprimary/20" placeholder="è«‹è¼¸å…¥å°ˆæ¡ˆ ID (å¯é¸)">
                            <p class="text-xs text-gray-400 mt-1">æ­¤ ID å°‡ç”¨æ–¼æª”æ¡ˆå‘½åå’Œè³‡æ–™å¤¾çµ„ç¹”ã€‚å¦‚ç„¡å°ˆæ¡ˆIDï¼Œç³»çµ±å°‡è‡ªå‹•ç”¢ç”Ÿè‡¨æ™‚ID</p>
                        </div>

                        <!-- åˆ†æä¸»é¡Œè¼¸å…¥ -->
                        <div class="mb-6">
                            <label for="analysis-topic" class="block text-sm font-medium text-gray-300 mb-2">åˆ†æä¸»é¡Œ *</label>
                            <input type="text" id="analysis-topic" class="w-full px-4 py-2 rounded-lg bg-techbg border border-techprimary/20" placeholder="ä¾‹å¦‚ï¼šå°ç£é›»å•†å¹³å°ã€æ•¸ä½è¡ŒéŠ·å·¥å…·ã€AI èŠå¤©æ©Ÿå™¨äººç­‰" required>
                            <p class="text-xs text-gray-400 mt-1">è«‹æè¿°æ‚¨è¦åˆ†æçš„å¸‚å ´æˆ–ç”¢å“é¡åˆ¥</p>
                        </div>

                        <!-- ç«¶çˆ­å°æ‰‹æ•¸é‡ -->
                        <div class="mb-6">
                            <label for="competitor-count" class="block text-sm font-medium text-gray-300 mb-2">ç«¶çˆ­å°æ‰‹æ•¸é‡</label>
                            <select id="competitor-count" class="w-full px-4 py-2 rounded-lg bg-techbg border border-techprimary/20">
                                <option value="5">5 å€‹</option>
                                <option value="10" selected>10 å€‹</option>
                                <option value="15">15 å€‹</option>
                                <option value="20">20 å€‹</option>
                            </select>
                        </div>

                        <!-- åˆ†ææ·±åº¦ -->
                        <div class="mb-6">
                            <label class="block text-sm font-medium text-gray-300 mb-2">åˆ†ææ·±åº¦</label>
                            <div class="space-y-2">
                                <label class="flex items-center">
                                    <input type="radio" name="analysis-depth" value="basic" class="mr-2">
                                    <span class="text-sm">åŸºç¤åˆ†æ (å¿«é€Ÿ)</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="radio" name="analysis-depth" value="standard" checked class="mr-2">
                                    <span class="text-sm">æ¨™æº–åˆ†æ (æ¨è–¦)</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="radio" name="analysis-depth" value="comprehensive" class="mr-2">
                                    <span class="text-sm">æ·±åº¦åˆ†æ (è©³ç´°)</span>
                                </label>
                            </div>
                        </div>

                        <button id="start-analysis-btn" class="w-full bg-gradient-to-tr from-techprimary to-techaccent font-bold text-white px-6 py-3 rounded-lg shadow-lg">é–‹å§‹åˆ†æ</button>
                    </section>
                </div>

                <!-- Step 2: å°æ‰‹ç¯©é¸èˆ‡è£œå…… -->
                <div id="step-2-content" class="step-panel" style="display: none;">
                    <section class="bg-techpanel rounded-xl shadow-2xl border border-techprimary/20 p-8">
                        <h2 class="text-2xl font-bold mb-6 text-techaccent">ğŸ¯ å°æ‰‹ç¯©é¸èˆ‡è£œå……</h2>
                        <div id="competitor-selection-content">
                            <p class="text-gray-400">è«‹å…ˆå®Œæˆæ­¥é©Ÿ 1 çš„åˆ†æè¨­å®š</p>
                        </div>
                    </section>
                </div>

                <!-- Step 3: å®Œæ•´å ±å‘Š -->
                <div id="step-3-content" class="step-panel" style="display: none;">
                    <section class="bg-techpanel rounded-xl shadow-2xl border border-techprimary/20 p-8">
                        <h2 class="text-2xl font-bold mb-6 text-techaccent">ğŸ“‹ å®Œæ•´å ±å‘Š</h2>
                        <div id="final-report-content">
                            <p class="text-gray-400">è«‹å…ˆå®Œæˆæ­¥é©Ÿ 2 çš„å°æ‰‹ç¯©é¸</p>
                        </div>
                    </section>
                </div>
            </div>

            <!-- æ­·å²ç´€éŒ„é¢æ¿ -->
            <div id="history-panel" class="panel">
                <section class="bg-techpanel rounded-xl shadow-2xl border border-techprimary/20 p-8">
                    <h2 class="text-2xl font-bold mb-6 text-techaccent">ğŸ“š æ­·å²ç´€éŒ„</h2>
                    <div id="history-content">
                        <p class="text-gray-400">æ­·å²ç´€éŒ„åŠŸèƒ½é–‹ç™¼ä¸­...</p>
                    </div>
                </section>
            </div>
        </div>
    </main>
</body>
</html>
